<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Grade Calculator</title>
    <a href="half_semester_calculator.html" style="color: lightblue;">Half-Semester Grade Calculator</a>
    <style>
        body {
            background-color: #2E2E2E;
            color: white;
            font-family: Arial, sans-serif;
        }

        h2, h3 {
            color: #F1F1F1;
        }

        label {
            color: #D1D1D1;
        }

        input, select, button {
            background-color: #3B3B3B;
            color: white;
            border: 1px solid #555;
            border-radius: 5px;
            padding: 8px;
            margin: 5px 0;
            width: 250px;
        }

        button {
            cursor: pointer;
            background-color: #4CAF50;
            border: none;
        }

        button:hover {
            background-color: #45a049;
        }

        input[type="number"], select {
            width: 100px;
        }

        #finalField {
            display: none;
        }
    </style>
    <script>
        function calculateFinalGrade() {
            let numQuarters = getNumQuarters();
            let classType = document.getElementById("classType").value;
            let desiredGrade = parseFloat(document.getElementById("desiredGrade").value);
            
            let quarterWeights = (classType === "AP") ? 22 : 20;
            let midtermWeight = (classType === "AP") ? 12 : 10;
            let finalExamWeight = (classType === "AP") ? 0 : 10;
            
            let totalWeight = 0, weightedSum = 0;
            
            for (let i = 1; i <= numQuarters; i++) {
                let quarterGrade = parseFloat(document.getElementById("q" + i).value) || 0;
                weightedSum += quarterGrade * quarterWeights;
                totalWeight += quarterWeights;
            }
            
            let midtermGrade = parseFloat(document.getElementById("midterm").value) || 0;
            let finalExamGrade = parseFloat(document.getElementById("final").value) || 0;
            
            if (numQuarters >= 3 || (numQuarters == 2 && document.getElementById("midterm").value)) {
                weightedSum += midtermGrade * midtermWeight;
                totalWeight += midtermWeight;
            }
            
            if (numQuarters == 4 && classType !== "AP" && document.getElementById("final").value) {
                weightedSum += finalExamGrade * finalExamWeight;
                totalWeight += finalExamWeight;
            }
            
            let finalGrade = (totalWeight > 0) ? (weightedSum / totalWeight) : 0;
            document.getElementById("result").innerText = "Final Grade: " + finalGrade.toFixed(2) + "%";
            
            calculateNeededGrade(numQuarters, classType, weightedSum, totalWeight, desiredGrade, midtermWeight, finalExamWeight, quarterWeights);
        }
        
        function getNumQuarters() {
            let numQuarters = 0;
            for (let i = 1; i <= 4; i++) {
                let quarterGrade = document.getElementById("q" + i).value;
                if (quarterGrade !== "") {
                    numQuarters++;
                }
            }
            return numQuarters;
        }
        
        function calculateNeededGrade(numQuarters, classType, weightedSum, totalWeight, desiredGrade, midtermWeight, finalExamWeight, quarterWeights) {
            let remainingWeight = 0, requiredGrade = 0;
            let resultText = "";
            
            if (numQuarters == 3) {
                remainingWeight = quarterWeights + ((classType !== "AP") ? finalExamWeight : 0);
                requiredGrade = ((desiredGrade * (totalWeight + remainingWeight)) - weightedSum) / remainingWeight;
                resultText = "You need a " + requiredGrade.toFixed(2) + "% in Quarter 4" + ((classType !== "AP") ? " and " + requiredGrade.toFixed(2) + "% on the final exam" : "") + " to achieve your desired grade.";
            } else if (numQuarters == 2 && !document.getElementById("midterm").value) {
                remainingWeight = midtermWeight + (2 * quarterWeights) + ((classType !== "AP") ? finalExamWeight : 0);
                requiredGrade = ((desiredGrade * (totalWeight + remainingWeight)) - weightedSum) / remainingWeight;
                resultText = "To achieve your desired grade, you need at least " + requiredGrade.toFixed(2) + "% on the midterm, next two quarters" + ((classType !== "AP") ? " and the final exam." : ".");
            } else if (numQuarters == 2 && document.getElementById("midterm").value) {
                remainingWeight = (2 * quarterWeights) + ((classType !== "AP") ? finalExamWeight : 0);
                requiredGrade = ((desiredGrade * (totalWeight + remainingWeight)) - weightedSum) / remainingWeight;
                resultText = "To achieve your desired grade, you need at least " + requiredGrade.toFixed(2) + "% in the next two quarters" + ((classType !== "AP") ? " and the final exam." : ".");
            } else if (numQuarters == 4 && classType !== "AP" && !document.getElementById("final").value) {
                remainingWeight = finalExamWeight;
                requiredGrade = ((desiredGrade * (totalWeight + remainingWeight)) - weightedSum) / remainingWeight;
                resultText = "You need a " + requiredGrade.toFixed(2) + "% on the final exam to achieve your desired grade.";
            }
            
            document.getElementById("neededGrade").innerText = resultText;
        }

        // Function to handle the visibility of the final exam field
        function toggleFinalField() {
            let classType = document.getElementById("classType").value;
            let finalField = document.getElementById("finalField");
            
            // Show or hide the final exam field based on the class type
            if (classType === "AP") {
                finalField.style.display = "none";  // Hide the field for AP
            } else {
                finalField.style.display = "block"; // Show the field for CP/Honors
            }
        }

        // Call toggleFinalField when the page loads to check the initial selection
        window.onload = function() {
            toggleFinalField();  // Check if the final field should be shown or hidden
        };

        // Add an event listener to handle changes to the class type dropdown
        document.getElementById("classType").addEventListener("change", toggleFinalField);

        // Function to clear all fields
        function clearFields() {
            // Reset all inputs
            document.querySelectorAll("input[type='number']").forEach(input => input.value = "");
            document.getElementById("desiredGrade").value = "";
            document.getElementById("classType").value = "CP"; // Reset class type to default (CP)
            toggleFinalField(); // Recheck visibility of the Final field
            document.getElementById("result").innerText = "";
            document.getElementById("neededGrade").innerText = "";
        }
    </script>
</head>
<body>
    <h2>Final Grade Calculator</h2>
    
    <label for="desiredGrade">Desired Final Grade (%):</label>
    <input type="number" id="desiredGrade" min="0" max="100"><br><br>
    
    <label for="q1">Quarter 1:</label>
    <input type="number" id="q1" min="0" max="100"><br>
    <label for="q2">Quarter 2:</label>
    <input type="number" id="q2" min="0" max="100"><br>
    <label for="q3">Quarter 3:</label>
    <input type="number" id="q3" min="0" max="100"><br>
    <label for="q4">Quarter 4:</label>
    <input type="number" id="q4" min="0" max="100"><br><br>
    
    <label for="midterm">Midterm:</label>
    <input type="number" id="midterm" min="0" max="100"><br><br>
    
    <!-- This is the Final Exam input, initially hidden -->
    <div id="finalField">
        <label for="final">Final Exam (CP/Honors only):</label>
        <input type="number" id="final" min="0" max="100"><br><br>
    </div>
    
    <label for="classType">Class Type:</label>
    <select id="classType">
        <option value="CP">CP/Honors</option>
        <option value="AP">AP</option>
    </select><br><br>
    
    <button onclick="calculateFinalGrade()">Calculate Final Grade</button>
    <button type="button" onclick="clearFields()">Clear All Fields</button><br><br>
    
    <h3 id="result"></h3>
    <h3 id="neededGrade"></h3>
</body>
</html>

